<div class="form-check form-switch toggle-inline @(Disabled ? "toggle-disabled" : "")">
    <input class="form-check-input"
           type="checkbox"
           role="switch"
           id="@Id"
           checked="@IsChecked"
           @onchange="OnInputChanged"
           disabled="@Disabled"
           aria-disabled="@(Disabled ? "true" : "false")"
           aria-checked="@(IsChecked ? "true" : "false")"
           @attributes="AdditionalAttributes" />
    @if (!string.IsNullOrEmpty(Label))
    {
        <label class="form-check-label toggle-inline-label @(IsChecked ? "toggle-inline-label-on" : "toggle-inline-label-off") @(Disabled ? "toggle-inline-label-disabled" : "")" for="@Id">@Label</label>
    }
</div>

@code {
    private bool isChecked;

    // Allow callers to supply an explicit id or fall back to a generated one
    [Parameter]
    public string Id { get; set; } = $"flexSwitch_{Guid.NewGuid():N}";

    private bool IsChecked
    {
        get => isChecked;
        set => isChecked = value;
    }

    protected override void OnInitialized()
    {
        isChecked = Checked;
    }

    protected override void OnParametersSet()
    {
        // keep internal state in sync when parent updates the Checked parameter
        if (Checked != isChecked)
        {
            isChecked = Checked;
        }
    }

    [Parameter]
    public string Label { get; set; } = string.Empty;

    [Parameter]
    public bool Checked { get; set; }

    [Parameter]
    public EventCallback<bool> CheckedChanged { get; set; }

    [Parameter]
    public bool Disabled { get; set; }

    // forward arbitrary attributes to the input
    [Parameter(CaptureUnmatchedValues = true)]
    public Dictionary<string, object>? AdditionalAttributes { get; set; }

    private async Task OnInputChanged(ChangeEventArgs e)
    {
        // Ignore user interaction when disabled
        if (Disabled)
        {
            return;
        }

        bool newValue = e?.Value switch
        {
            bool b => b,
            string s when bool.TryParse(s, out var bv) => bv,
            _ => isChecked
        };

        if (newValue == isChecked)
        {
            return; // avoid duplicate notifications
        }

        isChecked = newValue;
        await CheckedChanged.InvokeAsync(newValue);
    }
}
<style>
    .toggle-inline {
        display: inline-flex;
        align-items: center;
        gap: 12px;
    }

    .form-switch .form-check-input {
        width: 3.5em;
        height: 24px;
    }

    .toggle-inline-label {
        padding: 20px 0;
        font-size: 1rem;
        user-select: none;
        font-weight: 600;
    }

    /* When Value = false */
    .toggle-inline-label-off {
        color: rgba(0, 0, 0, 0.85); /* darker text */
    }

    /* When Value = true */
    .toggle-inline-label-on {
        color: #004d9b; /* blue */
    }

    /* Disabled state */
    .toggle-disabled {
        opacity: 0.65;
    }

    .toggle-inline-label-disabled {
        color: rgba(0, 0, 0, 0.38);
        cursor: not-allowed;
    }
</style>