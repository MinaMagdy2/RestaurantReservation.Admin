@page "/addRestaurant"
@page "/editRestaurant/{Id:guid}"

@attribute [Authorize]
@inherits ReactiveComponentBase<IEditRestaurantViewModel>
<PageComponent>
    @if (ViewModel != null)
    {
        <PageHeader Header="@Header" />
        <ShowError ClearError="ClearErrors" ErrorMessage="@ViewModel.ErrorMessage" HasError="ViewModel.HasError" />
        @if (ViewModel.IsLoading)
        {
            <SpinKitCircle />
        }
        else
        {
            <MudGrid>
                <MudItem xs="12">
                    <MudTabs Elevation="1" Rounded="true" PanelClass="pa-6" ActiveTabClass="border-solid border-2 mud-border-primary">
                        <MudTabPanel Text="Main Date" ToolTip="All Basic Data">
                            <ChildContent>
                                <MudGrid>
                                    <MudItem xs="12">
                                        <MudTextField Label="Language Name"
                                                      @bind-Value="ViewModel.RestaurantName"
                                                      AutoFocus="true" MaxLength="100" />
                                    </MudItem>
                                    <MudItem md="6" xs="12">
                                        <ToggleSwitch @bind-Checked="@ViewModel.ReserveOncePerStay" Label="Reserve Once Per Stay" />
                                    </MudItem>
                                    <MudItem md="6" xs="12">
                                        <ToggleSwitch @bind-Checked="@ViewModel.MustReserveDayBefore" Label="Must Reserve Day Before" />
                                    </MudItem>
                                    <MudItem md="6" xs="12">
                                        <ToggleSwitch @bind-Checked="@ViewModel.AdultsOnly" Label="Adults Only" />
                                    </MudItem>
                                    <MudItem md="6" xs="12">
                                        <ToggleSwitch @bind-Checked="@ViewModel.ChildrenOnly" Label="Children Only" />
                                    </MudItem>
                                    <MudItem xs="12">
                                        <ImageUpload @bind-Value="ViewModel.ImageUrl" />
                                    </MudItem>
                                    <MudItem xs="12" lg="4">
                                        <ToggleSwitch @bind-Checked="@acceptMeal" Label="Accept Meals" />
                                    </MudItem>
                                    <MudItem xs="12" lg="4">
                                        <EnumRadioButton TItem="Meals" Disabled="@(!acceptMeal)"
                                                         @bind-Value="ViewModel.Meals" Name="MealsChoose"
                                                         Caption="Select Meals" Exclude="@excludeMeals" />

                                    </MudItem>
                                </MudGrid>
                            </ChildContent>
                        </MudTabPanel>
                        <MudTabPanel Text="Timing" ToolTip="Add Timing">
                            <ChildContent>
                                <RestaurantTimingView @bind-Value="@ViewModel.Seats" />
                            </ChildContent>
                        </MudTabPanel>
                        <MudTabPanel Text="Conditions" ToolTip="Restaurant Conditions">
                            <ChildContent>
                                <MudGrid>
                                    <MudItem md="6" xs="12">
                                        <ToggleSwitch @bind-Checked="@ViewModel.CanReserveWithAnotherRestaurantOnSameDay"
                                                       Label="Can Reserve With Another Restaurant On Same Day" />
                                    </MudItem>
                                    <MudItem md="6" xs="12">
                                        <ToggleSwitch @bind-Checked="@ViewModel.MustSelectItemsBeforeSave"
                                                       Label="Must Select Items Before Save" />
                                    </MudItem>
                                    <MudItem lg="3" md="6" xs="12">
                                        <ToggleSwitch @bind-Checked="@ViewModel.UseMealPatternCondition"
                                                       Label="Use Meal Pattern" />
                                        <MultiSelectListBox TItem="MealPatternDto" TValue="string"
                                                            DataSource="@ViewModel.MealPatterns"
                                                            @bind-Value="@ViewModel.SelectedMealPatternCodes"
                                                            TextField="MeatPatName"
                                                            ValueField="MeatPatCode"
                                                            Size="6"
                                                            ShowSearch="true"
                                                            Disabled="@(!ViewModel.UseMealPatternCondition)" />
                                    </MudItem>
                                    <MudItem lg="3" md="6" xs="12">
                                        <ToggleSwitch @bind-Checked="@ViewModel.UseNationalityCondition"
                                                       Label="Use Nationality" />
                                        <MultiSelectListBox TItem="NationalityDto" TValue="string"
                                                            DataSource="@ViewModel.Nationalities"
                                                            @bind-Value="@ViewModel.SelectedNationalityCodes"
                                                            TextField="NationalityName"
                                                            ValueField="NationalityCode"
                                                            Size="6"
                                                            ShowSearch="true"
                                                            Disabled="@(!ViewModel.UseNationalityCondition)" />
                                    </MudItem>
                                    <MudItem lg="3" md="6" xs="12">
                                        <ToggleSwitch @bind-Checked="@ViewModel.UseTravelAgentCondition"
                                                       Label="Use Travel Agent" />
                                        <MultiSelectListBox TItem="TravelAgentDto" TValue="string"
                                                            DataSource="@ViewModel.TravelAgents"
                                                            @bind-Value="@ViewModel.SelectedTravelAgentCodes"
                                                            TextField="CompanyName"
                                                            ValueField="CompanyCode"
                                                            Size="6"
                                                            ShowSearch="true"
                                                            Disabled="@(!ViewModel.UseTravelAgentCondition)" />
                                    </MudItem>
                                    <MudItem lg="3" md="6" xs="12">
                                        <ToggleSwitch @bind-Checked="@ViewModel.UseRoomTypeCondition"
                                                       Label="Use Room Type" />
                                        <MultiSelectListBox TItem="RoomTypeDto" TValue="string"
                                                            DataSource="@ViewModel.RoomTypes"
                                                            @bind-Value="@ViewModel.SelectedRoomTypeCodes"
                                                            TextField="RoomTypeDescription"
                                                            ValueField="RoomTypeCode"
                                                            Size="6"
                                                            ShowSearch="true"
                                                            Disabled="@(!ViewModel.UseRoomTypeCondition)" />
                                    </MudItem>

                                </MudGrid>
                            </ChildContent>
                        </MudTabPanel>
                        <MudTabPanel Text="Messages" ToolTip="Add Messages">
                            <ChildContent>
                                <MudGrid>
                                    <MudItem xs="12">
                                        <ToggleSwitch @bind-Checked="ViewModel.DisplayMessageWhenSelect"
                                                       Label="Display Message When Select This Restaurant" />
                                    </MudItem>
                                    @if (ViewModel.DisplayMessageWhenSelect)
                                    {
                                        <MudItem xs="12">
                                            <RestaurantLanguageView @bind-Value="@ViewModel.Messages" />
                                        </MudItem>
                                    }
                                </MudGrid>
                            </ChildContent>
                        </MudTabPanel>
                        <MudTabPanel Text="Descriptions" ToolTip="Add Descriptions">
                            <ChildContent>
                                <RestaurantLanguageView @bind-Value="@ViewModel.Descriptions" />
                            </ChildContent>
                        </MudTabPanel>
                    </MudTabs>
                </MudItem>
                <MudItem sm="12">
                    <MudButton ButtonType="MudBlazor.ButtonType.Button"
                               OnClick="@Save"
                               Color="Color.Primary"
                               Variant="Variant.Filled"
                               StartIcon="@Icons.Material.Filled.Save"
                               IconColor="Color.Secondary"
                               Size="Size.Medium">Save</MudButton>
                    <MudButton Variant="Variant.Filled"
                               StartIcon="@Icons.Material.Filled.Cancel"
                               IconColor="Color.Dark" Color="Color.Secondary"
                               Size="Size.Medium" OnClick="@Cancel">Cancel</MudButton>
                </MudItem>
            </MudGrid>

        }
    }
</PageComponent>
    
@* <style>
    /* iOS Switch */
    .e-switch-wrapper.custom-iOS .e-switch-inner.e-switch-active,
    .e-switch-wrapper.custom-iOS:hover .e-switch-inner.e-switch-active .e-switch-on {
        background-color: #3df865;
        border-color: #3df665;
    }

    .e-switch-wrapper.custom-iOS {
        width: 60px;
        height: 24px;
    }

        .e-switch-wrapper.custom-iOS .e-switch-handle {
            width: 20px;
            height: 20px;
        }

            .e-switch-wrapper.custom-iOS .e-switch-handle.e-switch-active {
                margin-left: -22px;
            }
</style> *@